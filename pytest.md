# Мини-документация библиотеки `pytest`
**Автор: Ключиков Егор Владимирович 2025**

---

## Оглавление
1. [Введение](#введение)
2. [Установка](#установка)
3. [Базовое использование](#базовое-использование)
4. [Фикстуры (fixtures)](#фикстуры-fixtures)
5. [Параметризация тестов](#параметризация-тестов)
6. [Маркировка тестов](#маркировка-тестов)
7. [Плагины](#плагины)
8. [Полезные команды](#полезные-команды)
9. [Советы и лучшие практики](#советы-и-лучшие-практики)

---

## Введение

Вся информация была взята из официальной документации `PyTest` https://docs.pytest.org/
Я выцепил лишь самое главное, что нам пригодится при создании и настройке автотестов решений студентов.

**Так что же такое `PyTest` и с чем его едят?**
`PyTest` - это фреймворк для тестирования Python-кода, который позволяет писать простые и масштабируемые тесты. Он поддерживает:
- Автоматическое обнаружение тестов
- Фикстуры для управления зависимостями
- Параметризованное тестирование
- Богатый набор плагинов
- Подробные отчеты об ошибках

---

## Установка

Установите pytest с помощью pip:

```bash
pip install pytest
```

Проверьте установку:

```bash
pytest --version
```

---

## Базовое использование

1. Создайте файл с тестами (название должно начинаться с `test_` или заканчиваться `_test.py`)
2. Напишите функции, названия которых начинаются с `test_`

Пример (`test_sample.py`):

```python
def func(x):
    return x + 1

def test_answer():
    assert func(3) == 5  # Этот тест упадёт
```

Запустите тесты:

```bash
pytest
```

---

## Фикстуры (fixtures)

Фикстуры - это функции, которые выполняются перед тестами для предоставления данных или подготовки окружения.

Пример:

```python
import pytest

@pytest.fixture
def sample_data():
    return [1, 2, 3, 4, 5]

def test_sum(sample_data):
    assert sum(sample_data) == 15
```

---

## Параметризация тестов

Позволяет запускать один тест с разными входными данными:

```python
import pytest

@pytest.mark.parametrize("input,expected", [
    (3, 4),
    (5, 6),
    (10, 11),
])
def test_func(input, expected):
    assert func(input) == expected
```

---

## Маркировка тестов

Маркировка позволяет выбирать какие тесты запускать:

```python
@pytest.mark.slow
def test_long_running():
    import time
    time.sleep(10)
    assert True
```

Запуск только маркированных тестов:

```bash
pytest -m slow
```

---

## Плагины

Популярные плагины:
- `pytest-cov`: проверка покрытия кода тестами
- `pytest-xdist`: параллельный запуск тестов
- `pytest-mock`: интеграция с unittest.mock
- `pytest-django`: тестирование Django-приложений

Установка плагина:

```bash
pip install pytest-cov
```

---

## Полезные команды

- Запуск всех тестов: `pytest`
- Запуск тестов из конкретного файла: `pytest test_file.py`
- Запуск конкретного теста: `pytest test_file.py::test_name`
- Показать stdout при падении теста: `pytest -s`
- Запуск с подробным выводом: `pytest -v`
- Остановка после первого упавшего теста: `pytest -x`
- Запуск тестов с покрытием: `pytest --cov=myproject`

---

## Советы и лучшие практики

1. Называйте тестовые файлы и функции понятно
2. Используйте фикстуры для сложной подготовки данных
3. Разделяйте тесты на модули по функциональности
4. Избегайте зависимостей между тестами
5. Пишите маленькие, атомарные тесты
6. Используйте параметризацию для тестирования граничных случаев
7. Добавляйте маркеры для длительных тестов
8. Интегрируйте pytest с CI/CD системами

